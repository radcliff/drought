<!DOCTYPE html>
<html>
<head>
	<title>The California Drought</title>
	<meta charset="utf-8">
	<script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.8/d3.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.1.0/topojson.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/queue-async/1.0.7/queue.min.js"></script>
	<style>
		svg {
			border: 1px solid black;
		}
		path {
  		stroke: black;
  		stroke-width: 0.25px;
  		fill: white;
		}
		.pin {
			fill: black;
		}
	</style>
</head>
<body>
	<script>
		var places = [
		  {
		    name: "San Diego",
		    location: {
		      latitude: 32.715738,
		      longitude: -117.1610838
		    }
		  }
		]

		var svgWidth = window.innerWidth - (window.innerWidth / 3),
	    svgHeight = window.innerHeight - 20;

		var projection = d3.geo.albersUsa()
			.translate([svgWidth + (svgWidth / 2), svgHeight / 2])
			.scale([3000]);
		    
		var svg = d3.select("body").append("svg")
	    .attr("width", svgWidth)
	    .attr("height", svgHeight);

		var path = d3.geo.path()
		  .projection(projection);

    queue()
      .defer(d3.json, "california-drought-topo.json")
      .await(drawMap);

    function drawMap(error, map){
      svg.selectAll("path")
        .data(topojson.feature(map, map.objects.drought).features)
        .enter()
        .append("path")
        	.attr("d", path)
        	.attr("id", function(d){
        		return "dm" + d.id;
        });
      svg.selectAll(".dot")
      	.data(places)
        .enter()
        .append("circle")
          .attr("r", 3)
          .attr("transform", function(d){
            return "translate(" + projection([
              d.location.longitude,
              d.location.latitude
            ]) + ")"
          })
          .attr("class", "dot");
    }
	</script>
</body>
</html>
